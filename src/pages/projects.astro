---
import { getCollection } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";
import { formatDate, sortByDateDesc } from "../lib/posts";

const projects = sortByDateDesc(
  await getCollection("posts", ({ data }) => !data.draft && data.tags.includes("project")),
);

const projectEmoji: Record<string, string> = {
  "german-vocab-cli": "üß†",
  "git-commit-ai": "ü§ñ",
  arena: "‚öîÔ∏è",
  "builder-log": "üß±",
};

const internalProjectRoutes: Record<string, string> = {
  arena: "/projects/arena",
};
---

<BaseLayout title="Projects | Dogus Ural">
  <section class="section">
    <div class="container">
      <h1>üõ†Ô∏è Things I Build</h1>
      <ul class="project-bullets">
        {
          projects.map((project) => {
            const href = internalProjectRoutes[project.slug] ?? project.data.github;
            const isInternal = Boolean(internalProjectRoutes[project.slug]);
            return (
              <li>
                <div class="project-line">
                  <span class="emoji">{projectEmoji[project.slug] ?? "üõ†Ô∏è"}</span>
                  {href ? (
                    <a href={href} target={isInternal ? undefined : "_blank"} rel={isInternal ? undefined : "noreferrer"}>
                      {project.data.title}
                    </a>
                  ) : (
                    <span>{project.data.title}</span>
                  )}
                  <span class="pill">{formatDate(project.data.date)}</span>
                </div>
                <p class="muted">{project.data.excerpt}</p>
              </li>
            );
          })
        }
      </ul>
    </div>
  </section>
</BaseLayout>

<style>
  .project-bullets {
    margin-top: 1.2rem;
    padding-left: 1.2rem;
    font-family: "JetBrains Mono", "SFMono-Regular", "Menlo", monospace;
    line-height: 1.65;
  }

  .project-bullets li {
    margin-bottom: 0.85rem;
  }

  .project-line {
    display: flex;
    align-items: center;
    gap: 0.45rem;
    flex-wrap: wrap;
  }

  .emoji {
    margin-right: 0.35rem;
  }

  .project-bullets p {
    margin: 0.25rem 0 0;
    max-width: 70ch;
  }
</style>
